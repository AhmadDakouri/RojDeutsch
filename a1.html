<meta charset="UTF-8" />
    
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
<title>Ù…Ø³ØªÙˆÙ‰ A1</title>

    <style>
        :root {
            --primary-color: #4CAF50;
            --secondary-color: #2196F3;
            --error-color: #F44336;
            --accent-color: #FF9800;
            --success-color: #4CAF50;
            --bg-light: #f5f7fa;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            min-height: 100vh;
            padding: 15px;
        }

        .container {
            max-width: 850px;
            margin: auto;
        }

        header {
            text-align: center;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 25px;
        }

        h1 {
            background: linear-gradient(135deg, #2196F3, #21CBF3);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* âœ… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
        .home-page {
            text-align: center;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            margin-top: 20px;
        }

        .home-title {
            font-size: 2.2rem;
            margin-bottom: 10px;
            color: #2196F3;
        }

        .home-subtitle {
            font-size: 1.1rem;
            margin-bottom: 30px;
            color: #666;
        }

        .sections-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            max-width: 400px;
            margin: 0 auto;
        }

        .section-card {
            background: linear-gradient(135deg, #ffffff, #e8ecf3);
            border: 2px solid #d0d0d0;
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: 0.25s;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.15);
        }

        .section-card:hover {
            transform: translateY(-5px);
            border-color: var(--secondary-color);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .section-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .section-name {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .section-desc {
            font-size: 0.9rem;
            color: #666;
        }

        /* Ø²Ø± Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯ */
        .homepage-btn {
            margin-top: 20px;
            padding: 12px 24px;
            background: linear-gradient(135deg, #9C27B0, #E91E63);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: 0.25s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .homepage-btn:hover {
            opacity: 0.85;
            transform: translateY(-2px);
        }

        /* âœ… Ø´Ø¨ÙƒØ© Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„Ù…Ø§Øª */
        .words-grid {
            display: grid;
            grid-template-columns: 1fr 1fr; /* Ø¹Ù…ÙˆØ¯ÙŠÙ† */
            gap: 15px;
            margin-bottom: 25px;
        }

        /* âœ… ØªØµÙ…ÙŠÙ… Ø¹Ù…ÙˆØ¯ÙŠ Ù„Ù„Ø¬Ù…Ù„ */
        .sentences-vertical {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 25px;
        }

        .german-sentences-section, .translation-sentences-section {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
        }

        .section-label {
            font-size: 16px;
            font-weight: 600;
            color: #2196F3;
            margin-bottom: 8px;
            text-align: center;
            padding: 8px;
            background: rgba(33, 150, 243, 0.1);
            border-radius: 8px;
        }

        .words-column, .sentences-column {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .word-btn, .sentence-btn {
            min-height: 75px;
            padding: 12px;
            background: linear-gradient(135deg, #ffffff, #e8ecf3);
            border: 2px solid #d0d0d0;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            text-align: center;
            transition: 0.25s;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.15);
            line-height: 1.4;
        }

        .sentence-btn {
            font-size: 15px;
            min-height: 70px;
            white-space: normal;
            word-wrap: break-word;
        }

        .word-btn:hover, .sentence-btn:hover {
            transform: translateY(-3px);
            border-color: var(--secondary-color);
        }

        .word-btn.correct, .sentence-btn.correct {
            background: linear-gradient(135deg, #4CAF50, #7CD66B);
            color: white;
            border-color: var(--success-color);
        }

        .word-btn.incorrect, .sentence-btn.incorrect {
            background: linear-gradient(135deg, #F44336, #FF7A6A);
            color: white;
            border-color: var(--error-color);
        }

        .word-btn.selected, .sentence-btn.selected {
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(255, 152, 0, 0.3);
        }

        .navigation {
            display: flex;
            gap: 10px;
        }

        .nav-btn {
            flex: 1;
            padding: 12px;
            background: linear-gradient(135deg, #2196F3, #21CBF3);
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: .25s;
        }

        .nav-btn:hover {
            opacity: .85;
            transform: translateY(-2px);
        }

        .reset-btn {
            background: linear-gradient(135deg, #FF9800, #FF5722);
        }

        .back-btn {
            background: linear-gradient(135deg, #9C27B0, #E91E63);
        }

        .hidden {
            display: none !important;
        }

        /* âœ… Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¬Ù…Ù„ */
        .stats-container {
            display: flex;
            gap: 12px;
            margin-top: 16px;
        }

        .stat-box {
            flex: 1;
            background: linear-gradient(135deg, #f5f7fa, #c3cfe2);
            padding: 12px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-value {
            font-weight: 700;
            font-size: 20px;
        }

        .progress-container {
            margin-top: 14px;
        }

        .progress-bar {
            height: 12px;
            background: #e0e0e0;
            border-radius: 8px;
        }

        .progress {
            height: 100%;
            background: linear-gradient(135deg, #4CAF50, #8BC34A);
            border-radius: 8px;
            transition: width 0.3s ease;
        }

        .completion-message {
            margin-top: 14px;
            padding: 14px;
            border-radius: 10px;
            background: linear-gradient(135deg, #E8F5E9, #C8E6C9);
            text-align: center;
        }
    </style>



<div class="container">
    <!-- Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
    
<div id="home-page" class="home-page">
        
<div class="home-title">A1</div>
        
<div class="home-subtitle">Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø°ÙŠ ØªØ±ØºØ¨ ÙÙŠ Ø§Ù„Ø¨Ø¯Ø¡ Ø¨Ù‡</div>
        
        
<div class="sections-grid">
            
<div class="section-card" id="words-section-card">
                
<div class="section-icon">ğŸ“š</div>
                
<div class="section-name">Ù‚Ø³Ù… Ø§Ù„ÙƒÙ„Ù…Ø§Øª</div>
                
<div class="section-desc">ØªØ¹Ù„Ù… Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø£Ù„Ù…Ø§Ù†ÙŠØ© ÙˆÙ…Ø·Ø§Ø¨Ù‚ØªÙ‡Ø§ Ù…Ø¹ ØªØ±Ø¬Ù…Ø§ØªÙ‡Ø§</div>
            </div>
            
            
<div class="section-card" id="sentences-section-card">
                
<div class="section-icon">ğŸ’¬</div>
                
<div class="section-name">Ù‚Ø³Ù… Ø§Ù„Ø¬Ù…Ù„</div>
                
<div class="section-desc">ØªØ¹Ù„Ù… Ø§Ù„Ø¬Ù…Ù„ Ø§Ù„Ø£Ù„Ù…Ø§Ù†ÙŠØ© ÙˆÙ…Ù…Ø§Ø±Ø³Ø© Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§</div>
            </div>
        </div>

        <!-- Ø²Ø± Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯ -->
        <button class="homepage-btn" onclick="goToHomePage()">
            ğŸ  Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
        </button>
    </div>

    <!-- Ù‚Ø³Ù… Ø§Ù„ÙƒÙ„Ù…Ø§Øª -->
    
<div id="words-container" class="hidden" style="margin-top:20px;">
        
<div class="challenge-container" style="background:rgba(255,255,255,0.95);padding:18px;border-radius:12px;">
            
<div class="section-title" style="text-align:center;margin-bottom:12px;">
                
<h2> Ø§Ù„ØµÙØ­Ø© <span id="words-page-number">1</span></h2>
            </div>

            
<div class="challenge-content">
                
<div id="words-challenge"><!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ --></div>

                
<div class="stats-container">
                    
<div class="stat-box">
                        
<div>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙƒÙ„Ù…Ø§Øª</div>
                        
<div id="words-total-count" class="stat-value">0</div>
                    </div>
                    
<div class="stat-box">
                        
<div>Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©</div>
                        
<div id="words-completed-count" class="stat-value">0</div>
                    </div>
                    
<div class="stat-box">
                        
<div>Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©</div>
                        
<div id="words-remaining-count" class="stat-value">0</div>
                    </div>
                </div>

                
<div class="progress-container">
                    
<div style="display:flex;justify-content:space-between;margin-bottom:8px;">
                        <span>Ø§Ù„ØªÙ‚Ø¯Ù‘Ù…</span>
                        <span id="words-progress-percent">0%</span>
                    </div>
                    
<div class="progress-bar">
                        
<div id="words-progress" class="progress" style="width:0%;"></div>
                    </div>
                </div>

                
<div style="margin-top:16px;" class="navigation">
                    <button id="words-back-btn" class="nav-btn back-btn">Ø§Ù„Ø¹ÙˆØ¯Ø©</button>
                    <button id="words-prev-btn" class="nav-btn">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
                    <button id="words-reset-btn" class="nav-btn reset-btn">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ­Ø¯ÙŠ</button>
                    <button id="words-next-btn" class="nav-btn">Ø§Ù„ØªØ§Ù„ÙŠ</button>
                </div>

                
<div id="words-completion-message" class="hidden completion-message">
                    
<h3>ğŸ‰ ØªÙ‡Ø§Ù†ÙŠÙ†Ø§! Ø£ÙƒÙ…Ù„Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙƒÙ„Ù…Ø§Øª ğŸ‰</h3>
                </div>
            </div>
        </div>
    </div>

    <!-- Ù‚Ø³Ù… Ø§Ù„Ø¬Ù…Ù„ -->
    
<div id="sentences-container" class="hidden" style="margin-top:20px;">
        
<div class="challenge-container" style="background:rgba(255,255,255,0.95);padding:18px;border-radius:12px;">
            
<div class="section-title" style="text-align:center;margin-bottom:12px;">
                
<h2>Ù‚Ø³Ù… Ø§Ù„Ø¬Ù…Ù„ - Ø§Ù„ØµÙØ­Ø© <span id="sentences-page-number">1</span></h2>
            </div>
            
<div class="challenge-content">
                
<div id="sentences-challenge"><!-- Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ --></div>

                
<div class="stats-container">
                    
<div class="stat-box">
                        
<div>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¬Ù…Ù„</div>
                        
<div id="sentences-total-count" class="stat-value">0</div>
                    </div>
                    
<div class="stat-box">
                        
<div>Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©</div>
                        
<div id="sentences-completed-count" class="stat-value">0</div>
                    </div>
                    
<div class="stat-box">
                        
<div>Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©</div>
                        
<div id="sentences-remaining-count" class="stat-value">0</div>
                    </div>
                </div>

                
<div class="progress-container">
                    
<div style="display:flex;justify-content:space-between;margin-bottom:8px;">
                        <span>Ø§Ù„ØªÙ‚Ø¯Ù‘Ù…</span>
                        <span id="sentences-progress-percent">0%</span>
                    </div>
                    
<div class="progress-bar">
                        
<div id="sentences-progress" class="progress" style="width:0%;"></div>
                    </div>
                </div>

                
<div style="margin-top:16px;" class="navigation">
                    <button id="sentences-back-btn" class="nav-btn back-btn">Ø§Ù„Ø¹ÙˆØ¯Ø©</button>
                    <button id="sentences-prev-btn" class="nav-btn">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
                    <button id="sentences-reset-btn" class="nav-btn reset-btn">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ­Ø¯ÙŠ</button>
                    <button id="sentences-next-btn" class="nav-btn">Ø§Ù„ØªØ§Ù„ÙŠ</button>
                </div>

                
<div id="sentences-completion-message" class="hidden completion-message">
                    
<h3>ğŸ‰ ØªÙ‡Ø§Ù†ÙŠÙ†Ø§! Ø£ÙƒÙ…Ù„Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¬Ù…Ù„ ğŸ‰</h3>
                </div>
            </div>
        </div>
    </div>

    
<div id="loading-message" style="text-align:center;margin-top:30px;">
        Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...
    </div>
</div>

<!-- Ø£ØµÙˆØ§Øª -->
<audio id="correct-sound" src="https://assets.mixkit.co/sfx/preview/mixkit-correct-answer-tone-2870.mp3"></audio>
<audio id="incorrect-sound" src="https://assets.mixkit.co/sfx/preview/mixkit-wrong-answer-fail-notification-946.mp3"></audio>

<script>
/* -------------------------
   Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙˆØ§Ù„Ø¥Ø¹Ø¯Ø§Ø¯
   ------------------------- */
const appData = {
    currentSection: null,
    words: [],             // ÙŠØ­ØªÙˆÙŠ ÙƒØ§Ø¦Ù†Ø§Øª { german, translation }
    sentences: [],         // ÙŠØ­ØªÙˆÙŠ ÙƒØ§Ø¦Ù†Ø§Øª { german, translation }
    wordsProgress: {
        currentPage: 1,
        completedItems: new Set(),
        itemsPerPage: 5    // Ø§Ù„Ø¢Ù† 5 Ø£Ø²ÙˆØ§Ø¬ (ÙŠØ¹Ù†ÙŠ 10 Ø£Ø²Ø±Ø§Ø±: 5 Ø£Ù„Ù…Ø§Ù†ÙŠ + 5 ØªØ±Ø¬Ù…Ø©)
    },
    sentencesProgress: {
        currentPage: 1,
        completedItems: new Set(),
        itemsPerPage: 3    // Ø§Ù„Ø¢Ù† 3 Ø£Ø²ÙˆØ§Ø¬ (ÙŠØ¹Ù†ÙŠ 6 Ø£Ø²Ø±Ø§Ø±: 3 Ø£Ù„Ù…Ø§Ù†ÙŠ + 3 ØªØ±Ø¬Ù…Ø©)
    },
    // Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©
    selectedGermanObj: null,
    selectedTranslationText: null,
    selectedGermanSentence: null,
    selectedTranslationSentence: null
};

/* Ø¹Ù†Ø§ØµØ± DOM */
const elements = {
    homePage: document.getElementById('home-page'),
    wordsSectionCard: document.getElementById('words-section-card'),
    sentencesSectionCard: document.getElementById('sentences-section-card'),
    wordsContainer: document.getElementById('words-container'),
    sentencesContainer: document.getElementById('sentences-container'),
    wordsChallenge: document.getElementById('words-challenge'),
    sentencesChallenge: document.getElementById('sentences-challenge'),
    wordsPageNumber: document.getElementById('words-page-number'),
    sentencesPageNumber: document.getElementById('sentences-page-number'),
    wordsBackBtn: document.getElementById('words-back-btn'),
    wordsPrevBtn: document.getElementById('words-prev-btn'),
    wordsNextBtn: document.getElementById('words-next-btn'),
    wordsResetBtn: document.getElementById('words-reset-btn'),
    sentencesBackBtn: document.getElementById('sentences-back-btn'),
    sentencesPrevBtn: document.getElementById('sentences-prev-btn'),
    sentencesNextBtn: document.getElementById('sentences-next-btn'),
    sentencesResetBtn: document.getElementById('sentences-reset-btn'),
    loadingMessage: document.getElementById('loading-message'),
    correctSound: document.getElementById('correct-sound'),
    incorrectSound: document.getElementById('incorrect-sound'),
    wordsProgressBar: document.getElementById('words-progress'),
    wordsProgressPercent: document.getElementById('words-progress-percent'),
    wordsTotalCount: document.getElementById('words-total-count'),
    wordsCompletedCount: document.getElementById('words-completed-count'),
    wordsRemainingCount: document.getElementById('words-remaining-count'),
    wordsCompletionMessage: document.getElementById('words-completion-message'),
    sentencesProgressBar: document.getElementById('sentences-progress'),
    sentencesProgressPercent: document.getElementById('sentences-progress-percent'),
    sentencesTotalCount: document.getElementById('sentences-total-count'),
    sentencesCompletedCount: document.getElementById('sentences-completed-count'),
    sentencesRemainingCount: document.getElementById('sentences-remaining-count'),
    sentencesCompletionMessage: document.getElementById('sentences-completion-message')
};

/* -------------------------
   ÙˆØ¸ÙŠÙØ© Ø§Ù„Ù†Ø·Ù‚ Ù„Ù„ÙƒÙ„Ù…Ø§Øª ÙˆØ§Ù„Ø¬Ù…Ù„ Ø§Ù„Ø£Ù„Ù…Ø§Ù†ÙŠØ©
   ------------------------- */
function speakGermanText(text) {
    if ('speechSynthesis' in window) {
        // Ø¥ÙŠÙ‚Ø§Ù Ø£ÙŠ Ù†Ø·Ù‚ Ø³Ø§Ø¨Ù‚
        speechSynthesis.cancel();
        
        const utterance = new SpeechSynthesisUtterance(text);
        
        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø·Ù‚ Ø§Ù„Ø£Ù„Ù…Ø§Ù†ÙŠ
        utterance.lang = 'de-DE';
        utterance.rate = 0.9; // Ø³Ø±Ø¹Ø© Ø§Ù„Ù†Ø·Ù‚
        utterance.pitch = 1;  // Ù†Ø¨Ø±Ø© Ø§Ù„ØµÙˆØª
        utterance.volume = 1; // Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØµÙˆØª
        
        // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ø³ØªØ®Ø¯Ø§Ù… ØµÙˆØª Ø£Ù†Ø«ÙˆÙŠ Ø¥Ù† ÙˆØ¬Ø¯
        const voices = speechSynthesis.getVoices();
        const germanVoice = voices.find(voice => 
            voice.lang.startsWith('de') && voice.name.includes('Female')
        ) || voices.find(voice => 
            voice.lang.startsWith('de')
        );
        
        if (germanVoice) {
            utterance.voice = germanVoice;
        }
        
        utterance.onstart = function() {
            console.log('Ø¨Ø¯Ø¡ Ø§Ù„Ù†Ø·Ù‚: ' + text);
        };
        
        utterance.onerror = function(event) {
            console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù†Ø·Ù‚:', event.error);
        };
        
        speechSynthesis.speak(utterance);
    } else {
        console.warn('Ù…ØªØµÙØ­Ùƒ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø®Ø§ØµÙŠØ© Ø§Ù„Ù†Ø·Ù‚ Text-to-Speech');
        // Ø¨Ø¯ÙŠÙ„: Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø®Ø¯Ù…Ø© Ø§Ù„Ù†Ø·Ù‚ Ø¹Ø¨Ø± Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª
        playOnlineTTS(text);
    }
}

/* -------------------------
   Ø¨Ø¯ÙŠÙ„ Ù„Ø®Ø¯Ù…Ø© Ø§Ù„Ù†Ø·Ù‚ Ø¹Ø¨Ø± Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª
   ------------------------- */
function playOnlineTTS(text) {
    // ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø®Ø¯Ù…Ø© Ø§Ù„Ù†Ø·Ù‚ Ø¹Ø¨Ø± Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª Ù‡Ù†Ø§
    // Ù…Ø«Ø§Ù„: Google Text-to-Speech Ø£Ùˆ Ø£ÙŠ Ø®Ø¯Ù…Ø© Ø£Ø®Ø±Ù‰
    console.log('Ø§Ù„Ù†Ø·Ù‚ Ø¹Ø¨Ø± Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª: ' + text);
    
    // Ù‡Ø°Ø§ Ù…Ø«Ø§Ù„ Ù…Ø¨Ø³Ø· - ØªØ­ØªØ§Ø¬ Ù„ØªØ·Ø¨ÙŠÙ‚Ù‡ Ø­Ø³Ø¨ Ø§Ù„Ø®Ø¯Ù…Ø© Ø§Ù„ØªÙŠ ØªØ±ÙŠØ¯ Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§
    const audioUrl = `https://translate.google.com/translate_tts?ie=UTF-8&q=${encodeURIComponent(text)}&tl=de&client=tw-ob`;
    
    const audio = new Audio(audioUrl);
    audio.play().catch(e => console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª:', e));
}

/* -------------------------
   ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (a1.json, a1ahmad.json)
   Ù‚Ù… Ø¨ÙˆØ¶Ø¹ Ù…Ù„ÙØ§Øª JSON ÙÙŠ Ù†ÙØ³ Ø§Ù„Ù…Ø¬Ù„Ø¯
   ------------------------- */
async function loadData() {
    try {
        const respW = await fetch('a1.json');
        if (!respW.ok) throw new Error('ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ a1.json');
        appData.words = await respW.json();

        const respS = await fetch('a1ahmad.json');
        if (!respS.ok) throw new Error('ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ a1ahmad.json');
        appData.sentences = await respS.json();
    } catch (err) {
        console.error(err);
        elements.loadingMessage.textContent = 'Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ files a1.json Ùˆ a1ahmad.json';
        throw err;
    }
}

/* -------------------------
   Ø­ÙØ¸ ÙˆØ§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„ØªÙ‚Ø¯Ù‘Ù… Ù…Ù† localStorage
   ------------------------- */
function loadProgress() {
    const raw = localStorage.getItem('germanLearningAppProgress');
    if (!raw) return;
    try {
        const p = JSON.parse(raw);
        if (p.wordsProgress) {
            appData.wordsProgress.currentPage = p.wordsProgress.currentPage || 1;
            appData.wordsProgress.completedItems = new Set(p.wordsProgress.completedItems || []);
        }
        if (p.sentencesProgress) {
            appData.sentencesProgress.currentPage = p.sentencesProgress.currentPage || 1;
            appData.sentencesProgress.completedItems = new Set(p.sentencesProgress.completedItems || []);
        }
    } catch (e) {
        console.warn('ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚Ø¯Ù‘Ù… Ø§Ù„Ù…Ø­ÙÙˆØ¸:', e);
    }
}

function saveProgress() {
    const p = {
        wordsProgress: {
            currentPage: appData.wordsProgress.currentPage,
            completedItems: Array.from(appData.wordsProgress.completedItems)
        },
        sentencesProgress: {
            currentPage: appData.sentencesProgress.currentPage,
            completedItems: Array.from(appData.sentencesProgress.completedItems)
        }
    };
    localStorage.setItem('germanLearningAppProgress', JSON.stringify(p));
}

/* -------------------------
   Ù…Ø³Ø§Ø¹Ø¯: Ø®Ù„Ø· Ù…ØµÙÙˆÙØ©
   ------------------------- */
function shuffleArray(arr) {
    const a = arr.slice();
    for (let i = a.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [a[i], a[j]] = [a[j], a[i]];
    }
    return a;
}

/* -------------------------
   Ø®Ù„Ø· Ø§Ù„ØªØ±Ø¬Ù…Ø© Ù…Ø¹ Ø¶Ù…Ø§Ù† Ø£Ù„Ø§ ØªÙƒÙˆÙ† Ù…Ù‚Ø§Ø¨Ù„Ø© ÙÙŠ Ù†ÙØ³ Ø§Ù„ØµÙ
   (ØªÙ…Ù†Ø¹ Ø£Ù† ØªÙƒÙˆÙ† Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© ÙÙŠ Ù†ÙØ³ Ø§Ù„ØµÙ Ù…Ø¹ Ø§Ù„ÙƒÙ„Ù…Ø©)
   ------------------------- */
function shuffleAvoidMatches(germanItems, translations) {
    // germanItems: array of objects length N
    // translations: array of corresponding translations length N
    let shuffled = shuffleArray(translations);
    // Ø­Ø§ÙˆÙ„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø®Ù„Ø· Ø¹Ø¯Ø© Ù…Ø±Ø§Øª Ø¥Ù† ÙˆÙØ¬Ø¯Øª Ù…Ø·Ø§Ø¨Ù‚Ø© ÙÙŠ Ù†ÙØ³ Ø§Ù„ØµÙ
    const maxTries = 50;
    let tries = 0;
    while (tries < maxTries) {
        let bad = false;
        for (let i = 0; i < germanItems.length; i++) {
            if (germanItems[i].translation === shuffled[i]) {
                bad = true;
                break;
            }
        }
        if (!bad) return shuffled;
        shuffled = shuffleArray(shuffled);
        tries++;
    }
    // Ø¥Ù† ÙØ´Ù„Ù†Ø§ (Ù†Ø§Ø¯Ø±)ØŒ Ù†Ù‚ÙˆÙ… Ø¨Ø¥Ø²Ø§Ø­Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø· Ù„Ø¶Ù…Ø§Ù† Ø§Ø®ØªÙ„Ø§Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ ÙÙŠ Ù…Ø¹Ø¸Ù… Ø§Ù„Ø­Ø§Ù„Ø§Øª
    if (germanItems.length > 1) {
        shuffled = shuffled.slice(1).concat(shuffled[0]);
    }
    return shuffled;
}

/* -------------------------
   Ø±Ù†Ø¯Ø± Ø§Ù„ØªØ­Ø¯ÙŠ - Ù‚Ø³Ù… Ø§Ù„ÙƒÙ„Ù…Ø§Øª (ÙŠØ¹Ø±Ø¶ 5 Ø£Ø²ÙˆØ§Ø¬: 5 Ø£Ù„Ù…Ø§Ù†ÙŠ + 5 ØªØ±Ø¬Ù…Ø©)
   ------------------------- */
function renderWordsChallenge() {
    const progress = appData.wordsProgress;
    const data = appData.words;
    if (!data || data.length === 0) {
        elements.wordsChallenge.innerHTML = '<div style="padding:14px;text-align:center;">Ù„Ø§ ØªÙˆØ¬Ø¯ ÙƒÙ„Ù…Ø§Øª Ø¨Ø¹Ø¯.</div>';
        return;
    }

    const totalPages = Math.ceil(data.length / progress.itemsPerPage);
    if (progress.currentPage > totalPages) progress.currentPage = totalPages;

    const startIndex = (progress.currentPage - 1) * progress.itemsPerPage;
    const endIndex = Math.min(startIndex + progress.itemsPerPage, data.length);
    const currentItems = data.slice(startIndex, endIndex); // length <= 5

    // Ø§Ø­ÙØ¸ Ù…Ø±Ø¬Ø¹ Ù„Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶Ø© Ø­ØªÙ‰ Ù†Ø¹Ø±Ù Ø£ÙŠ Ø¹Ù†ØµØ± Ù‡Ùˆ ØµØ­ÙŠØ­ Ø¹Ù†Ø¯ Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø©
    appData.currentDisplayedGerman = currentItems; // array of objects

    // ØªØ­Ø¶ÙŠØ± Ø§Ù„ØªØ±Ø¬Ù…Ø© (Ù…Ø®ÙÙˆØ·Ø© ÙˆÙ…ØªØ¬Ù†Ù‘Ø¨Ø© Ù„ÙˆØ¬ÙˆØ¯ Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø© Ø¬Ù†Ø¨Ø§Ù‹ Ø¥Ù„Ù‰ Ø¬Ù†Ø¨)
    const originalTranslations = currentItems.map(x => x.translation);
    const translationsShuffled = shuffleAvoidMatches(currentItems, originalTranslations);

    // Ø¨Ù†Ø§Ø¡ HTML: Ø¹Ù…ÙˆØ¯ ÙŠÙ…ÙŠÙ† Ù„Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø£Ù„Ù…Ø§Ù†ÙŠØ© ÙˆØ¹Ù…ÙˆØ¯ ÙŠØ³Ø§Ø± Ù„Ù„ØªØ±Ø¬Ù…Ø§Øª
    let html = `<div class="words-grid">`;

    // ÙŠÙ…ÙŠÙ† â€” ÙƒÙ„Ù…Ø§Øª Ø£Ù„Ù…Ø§Ù†ÙŠØ© (Ø¹Ø±Ø¶ Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰ Ù„Ù„Ø£Ø³ÙÙ„)
    html += `<div class="words-column" aria-label="ÙƒÙ„Ù…Ø§Øª Ø£Ù„Ù…Ø§Ù†ÙŠØ©">`;
    for (let i = 0; i < currentItems.length; i++) {
        const w = currentItems[i];
        // data-pos = Ø§Ù„Ù…ÙˆØ¶Ø¹ Ø¯Ø§Ø®Ù„ Ø§Ù„ØµÙØ­Ø©
        html += `<button class="word-btn german-word" data-pos="${i}" data-global-index="${startIndex + i}" onclick="onGermanClick(event)">${escapeHtml(w.german)}</button>`;
    }
    // Fill up to 5 rows with empty placeholders Ù„Ùˆ ÙƒØ§Ù† Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø£Ù‚Ù„ Ù…Ù† 5
    for (let k = currentItems.length; k < progress.itemsPerPage; k++) {
        html += `<div style="min-height:75px;"></div>`;
    }
    html += `</div>`;

    // ÙŠØ³Ø§Ø± â€” ØªØ±Ø¬Ù…Ø§Øª
    html += `<div class="words-column" aria-label="ØªØ±Ø¬Ù…Ø§Øª">`;
    for (let i = 0; i < translationsShuffled.length; i++) {
        const t = translationsShuffled[i];
        html += `<button class="word-btn translation-word" data-pos="${i}" onclick="onTranslationClick(event)">${escapeHtml(t)}</button>`;
    }
    for (let k = translationsShuffled.length; k < progress.itemsPerPage; k++) {
        html += `<div style="min-height:75px;"></div>`;
    }
    html += `</div>`;

    html += `</div>`; // .words-grid

    elements.wordsChallenge.innerHTML = html;

    // ØªØ­Ø¯ÙŠØ« Ø£Ø±Ù‚Ø§Ù… ÙˆØ¥Ø­ØµØ§Ø¦ÙŠØ§Øª
    elements.wordsPageNumber.textContent = progress.currentPage;
    updateWordsStats();
    updateWordsProgressBar();

    // Ø¥Ø®ÙØ§Ø¡ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø§ÙƒØªÙ…Ø§Ù„ Ø¥Ù† ÙƒØ§Ù†Øª Ø¸Ø§Ù‡Ø±Ø©
    elements.wordsCompletionMessage.classList.add('hidden');
}

/* -------------------------
   Ø±Ù†Ø¯Ø± Ø§Ù„ØªØ­Ø¯ÙŠ - Ù‚Ø³Ù… Ø§Ù„Ø¬Ù…Ù„ (ØªØµÙ…ÙŠÙ… Ø¹Ù…ÙˆØ¯ÙŠ)
   ------------------------- */
function renderSentencesChallenge() {
    const progress = appData.sentencesProgress;
    const data = appData.sentences;
    if (!data || data.length === 0) {
        elements.sentencesChallenge.innerHTML = '<div style="padding:14px;text-align:center;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¬Ù…Ù„ Ø¨Ø¹Ø¯.</div>';
        return;
    }

    const totalPages = Math.ceil(data.length / progress.itemsPerPage);
    if (progress.currentPage > totalPages) progress.currentPage = totalPages;

    const startIndex = (progress.currentPage - 1) * progress.itemsPerPage;
    const endIndex = Math.min(startIndex + progress.itemsPerPage, data.length);
    const currentItems = data.slice(startIndex, endIndex); // length <= 3

    // Ø§Ø­ÙØ¸ Ù…Ø±Ø¬Ø¹ Ù„Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶Ø© Ø­ØªÙ‰ Ù†Ø¹Ø±Ù Ø£ÙŠ Ø¹Ù†ØµØ± Ù‡Ùˆ ØµØ­ÙŠØ­ Ø¹Ù†Ø¯ Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø©
    appData.currentDisplayedSentences = currentItems; // array of objects

    // ØªØ­Ø¶ÙŠØ± Ø§Ù„ØªØ±Ø¬Ù…Ø© (Ù…Ø®ÙÙˆØ·Ø© ÙˆÙ…ØªØ¬Ù†Ù‘Ø¨Ø© Ù„ÙˆØ¬ÙˆØ¯ Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø© Ø¬Ù†Ø¨Ø§Ù‹ Ø¥Ù„Ù‰ Ø¬Ù†Ø¨)
    const originalTranslations = currentItems.map(x => x.translation);
    const translationsShuffled = shuffleAvoidMatches(currentItems, originalTranslations);

    // Ø¨Ù†Ø§Ø¡ HTML: ØªØµÙ…ÙŠÙ… Ø¹Ù…ÙˆØ¯ÙŠ - Ø§Ù„Ø¬Ù…Ù„ Ø§Ù„Ø£Ù„Ù…Ø§Ù†ÙŠØ© Ø£ÙˆÙ„Ø§Ù‹ Ø«Ù… Ø§Ù„ØªØ±Ø¬Ù…Ø§Øª ØªØ­ØªÙ‡Ø§
    let html = `<div class="sentences-vertical">`;

    // Ù‚Ø³Ù… Ø§Ù„Ø¬Ù…Ù„ Ø§Ù„Ø£Ù„Ù…Ø§Ù†ÙŠØ© (ÙÙŠ Ø§Ù„Ø£Ø¹Ù„Ù‰)
    html += `<div class="german-sentences-section">`;
    html += `<div class="section-label">Ø§Ù„Ø¬Ù…Ù„ Ø§Ù„Ø£Ù„Ù…Ø§Ù†ÙŠØ©</div>`;
    for (let i = 0; i < currentItems.length; i++) {
        const s = currentItems[i];
        html += `<button class="sentence-btn german-sentence" data-pos="${i}" data-global-index="${startIndex + i}" onclick="onGermanSentenceClick(event)">${escapeHtml(s.german)}</button>`;
    }
    // Fill up to 3 rows with empty placeholders Ù„Ùˆ ÙƒØ§Ù† Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø£Ù‚Ù„ Ù…Ù† 3
    for (let k = currentItems.length; k < progress.itemsPerPage; k++) {
        html += `<div style="min-height:70px;"></div>`;
    }
    html += `</div>`;

    // Ù‚Ø³Ù… Ø§Ù„ØªØ±Ø¬Ù…Ø§Øª (ÙÙŠ Ø§Ù„Ø£Ø³ÙÙ„)
    html += `<div class="translation-sentences-section">`;
    html += `<div class="section-label">Ø§Ù„ØªØ±Ø¬Ù…Ø§Øª</div>`;
    for (let i = 0; i < translationsShuffled.length; i++) {
        const t = translationsShuffled[i];
        html += `<button class="sentence-btn translation-sentence" data-pos="${i}" onclick="onTranslationSentenceClick(event)">${escapeHtml(t)}</button>`;
    }
    for (let k = translationsShuffled.length; k < progress.itemsPerPage; k++) {
        html += `<div style="min-height:70px;"></div>`;
    }
    html += `</div>`;

    html += `</div>`; // .sentences-vertical

    elements.sentencesChallenge.innerHTML = html;

    // ØªØ­Ø¯ÙŠØ« Ø£Ø±Ù‚Ø§Ù… ÙˆØ¥Ø­ØµØ§Ø¦ÙŠØ§Øª
    elements.sentencesPageNumber.textContent = progress.currentPage;
    updateSentencesStats();
    updateSentencesProgressBar();

    // Ø¥Ø®ÙØ§Ø¡ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø§ÙƒØªÙ…Ø§Ù„ Ø¥Ù† ÙƒØ§Ù†Øª Ø¸Ø§Ù‡Ø±Ø©
    elements.sentencesCompletionMessage.classList.add('hidden');
}

/* -------------------------
   Helpers: Ù‡Ø§Ù†Ø¯Ù„Ø§Øª Ø§Ù„Ù†Ù‚Ø± - Ù‚Ø³Ù… Ø§Ù„ÙƒÙ„Ù…Ø§Øª
   ------------------------- */
function onGermanClick(e) {
    // ØªÙ†Ø¸ÙŠÙ ØªØ­Ø¯ÙŠØ¯ Ø³Ø§Ø¨Ù‚
    document.querySelectorAll('.german-word').forEach(b => b.classList.remove('selected'));
    const btn = e.currentTarget;
    btn.classList.add('selected');

    const pos = Number(btn.dataset.pos);
    const globalIndex = Number(btn.dataset.globalIndex);
    appData.selectedGermanObj = {
        pos,
        globalIndex,
        german: appData.currentDisplayedGerman[pos].german,
        translation: appData.currentDisplayedGerman[pos].translation
    };

    // Ù†Ø·Ù‚ Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ø£Ù„Ù…Ø§Ù†ÙŠØ© Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø±
    speakGermanText(appData.currentDisplayedGerman[pos].german);

    // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„ØªØ±Ø¬Ù…Ø© Ù…Ø®ØªØ§Ø±Ø©ØŒ ØªØ­Ù‚Ù‚
    if (appData.selectedTranslationText !== null) checkWordsMatch();
}

function onTranslationClick(e) {
    // ØªÙ†Ø¸ÙŠÙ ØªØ­Ø¯ÙŠØ¯ Ø³Ø§Ø¨Ù‚
    document.querySelectorAll('.translation-word').forEach(b => b.classList.remove('selected'));
    const btn = e.currentTarget;
    btn.classList.add('selected');
    appData.selectedTranslationText = btn.textContent;

    if (appData.selectedGermanObj !== null) checkWordsMatch();
}

/* -------------------------
   Helpers: Ù‡Ø§Ù†Ø¯Ù„Ø§Øª Ø§Ù„Ù†Ù‚Ø± - Ù‚Ø³Ù… Ø§Ù„Ø¬Ù…Ù„
   ------------------------- */
function onGermanSentenceClick(e) {
    // ØªÙ†Ø¸ÙŠÙ ØªØ­Ø¯ÙŠØ¯ Ø³Ø§Ø¨Ù‚
    document.querySelectorAll('.german-sentence').forEach(b => b.classList.remove('selected'));
    const btn = e.currentTarget;
    btn.classList.add('selected');

    const pos = Number(btn.dataset.pos);
    const globalIndex = Number(btn.dataset.globalIndex);
    appData.selectedGermanSentence = {
        pos,
        globalIndex,
        german: appData.currentDisplayedSentences[pos].german,
        translation: appData.currentDisplayedSentences[pos].translation
    };

    // Ù†Ø·Ù‚ Ø§Ù„Ø¬Ù…Ù„Ø© Ø§Ù„Ø£Ù„Ù…Ø§Ù†ÙŠØ© Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø±
    speakGermanText(appData.currentDisplayedSentences[pos].german);

    // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„ØªØ±Ø¬Ù…Ø© Ù…Ø®ØªØ§Ø±Ø©ØŒ ØªØ­Ù‚Ù‚
    if (appData.selectedTranslationSentence !== null) checkSentencesMatch();
}

function onTranslationSentenceClick(e) {
    // ØªÙ†Ø¸ÙŠÙ ØªØ­Ø¯ÙŠØ¯ Ø³Ø§Ø¨Ù‚
    document.querySelectorAll('.translation-sentence').forEach(b => b.classList.remove('selected'));
    const btn = e.currentTarget;
    btn.classList.add('selected');
    appData.selectedTranslationSentence = btn.textContent;

    if (appData.selectedGermanSentence !== null) checkSentencesMatch();
}

/* -------------------------
   Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø© (Ù‚Ø³Ù… Ø§Ù„ÙƒÙ„Ù…Ø§Øª)
   ------------------------- */
function checkWordsMatch() {
    const germanObj = appData.selectedGermanObj;
    const translationText = appData.selectedTranslationText;

    // Ø§Ù„Ø¹Ù†Ø§ØµØ± DOM: Ù†Ø¨Ø­Ø« Ø§Ù„Ø²Ø±ÙŠÙ† Ø§Ù„Ù…Ø­Ø¯Ø¯ÙŠÙ†
    const germanBtn = document.querySelector(`.german-word[data-pos="${germanObj.pos}"]`);
    // Ù„ØªØ­Ø¯ÙŠØ¯ Ø¹Ù†ØµØ± Ø§Ù„ØªØ±Ø¬Ù…Ø©: Ù†Ø¨Ø­Ø« Ø£ÙˆÙ„ Ø²Ø± ØªØ±Ø¬Ù…Ø© ÙŠØ­ØªÙˆÙŠ Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚
    const translationBtns = Array.from(document.querySelectorAll('.translation-word'));
    const translationBtn = translationBtns.find(b => b.textContent === translationText);

    if (!germanBtn || !translationBtn) {
        clearSelectionTemp();
        return;
    }

    // ØµØ­ÙŠØ­ Ø£Ù… Ø®Ø·Ø£ØŸ
    const isCorrect = (germanObj.translation === translationText);

    if (isCorrect) {
        // ØªÙ…ÙŠÙŠØ² Ø¨ØµÙŠØºØ© ØµØ­ÙŠØ­Ø©
        germanBtn.classList.remove('selected');
        translationBtn.classList.remove('selected');
        germanBtn.classList.add('correct');
        translationBtn.classList.add('correct');

        // Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø¯Ù‘Ù…: Ù†Ø³ØªØ®Ø¯Ù… globalIndex Ø§Ù„ÙƒØ§Ù…Ù„
        appData.wordsProgress.completedItems.add(String(germanObj.globalIndex));
        saveProgress();
        elements.correctSound.currentTime = 0;
        elements.correctSound.play();

        // Ø¥Ø¹Ø§Ø¯Ø© ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª Ø¨Ø¹Ø¯ Ù„Ø­Ø¸Ø© Ø¨Ø³ÙŠØ·Ø© ÙˆØ¥Ø¹Ø§Ø¯Ø© Ø±Ù†Ø¯Ø±/ØªÙ‚Ø¯Ù… Ø§Ù„ØµÙØ­Ø© Ø¥Ù† Ù„Ø²Ù…
        setTimeout(() => {
            clearSelectionTemp();
            // Ø¥Ù† ÙƒØ§Ù†Øª ÙƒÙ„ Ø¹Ù†Ø§ØµØ± Ø§Ù„ØµÙØ­Ø© ØµØ­ÙŠØ­Ø© -> Ù†Ù†ØªÙ‚Ù„ Ù„Ù„ØµÙØ­Ø© Ø§Ù„ØªØ§Ù„ÙŠØ© Ø£Ùˆ Ù†Ø¹Ø±Ø¶ Ø§ÙƒØªÙ…Ø§Ù„
            const allGermanBtns = document.querySelectorAll('.german-word');
            const allCorrect = Array.from(allGermanBtns).every(b => b.classList.contains('correct'));
            if (allCorrect) {
                // Ø²ÙŠØ§Ø¯Ø© ØµÙØ­Ø© Ø¥Ù† Ù„Ù… ØªÙƒÙ† Ø§Ù„Ø£Ø®ÙŠØ±Ø©
                const totalPages = Math.ceil(appData.words.length / appData.wordsProgress.itemsPerPage);
                if (appData.wordsProgress.currentPage < totalPages) {
                    appData.wordsProgress.currentPage++;
                } else {
                    // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ù…ÙƒØªÙ…Ù„Ø© ÙÙŠ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ ÙƒÙƒÙ„
                    if (appData.wordsProgress.completedItems.size >= appData.words.length) {
                        elements.wordsChallenge.innerHTML = '';
                        elements.wordsCompletionMessage.classList.remove('hidden');
                    }
                }
                saveProgress();
                renderWordsChallenge();
            }
        }, 700);

    } else {
        // ØªÙ…ÙŠÙŠØ² Ø®Ø·Ø£
        germanBtn.classList.remove('selected');
        translationBtn.classList.remove('selected');
        germanBtn.classList.add('incorrect');
        translationBtn.classList.add('incorrect');
        elements.incorrectSound.currentTime = 0;
        elements.incorrectSound.play();

        setTimeout(() => {
            germanBtn.classList.remove('incorrect');
            translationBtn.classList.remove('incorrect');
            clearSelectionTemp();
        }, 800);
    }
}

/* -------------------------
   Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø© (Ù‚Ø³Ù… Ø§Ù„Ø¬Ù…Ù„)
   ------------------------- */
function checkSentencesMatch() {
    const germanSentence = appData.selectedGermanSentence;
    const translationText = appData.selectedTranslationSentence;

    // Ø§Ù„Ø¹Ù†Ø§ØµØ± DOM: Ù†Ø¨Ø­Ø« Ø§Ù„Ø²Ø±ÙŠÙ† Ø§Ù„Ù…Ø­Ø¯Ø¯ÙŠÙ†
    const germanBtn = document.querySelector(`.german-sentence[data-pos="${germanSentence.pos}"]`);
    // Ù„ØªØ­Ø¯ÙŠØ¯ Ø¹Ù†ØµØ± Ø§Ù„ØªØ±Ø¬Ù…Ø©: Ù†Ø¨Ø­Ø« Ø£ÙˆÙ„ Ø²Ø± ØªØ±Ø¬Ù…Ø© ÙŠØ­ØªÙˆÙŠ Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚
    const translationBtns = Array.from(document.querySelectorAll('.translation-sentence'));
    const translationBtn = translationBtns.find(b => b.textContent === translationText);

    if (!germanBtn || !translationBtn) {
        clearSelectionTempSentences();
        return;
    }

    // ØµØ­ÙŠØ­ Ø£Ù… Ø®Ø·Ø£ØŸ
    const isCorrect = (germanSentence.translation === translationText);

    if (isCorrect) {
        // ØªÙ…ÙŠÙŠØ² Ø¨ØµÙŠØºØ© ØµØ­ÙŠØ­Ø©
        germanBtn.classList.remove('selected');
        translationBtn.classList.remove('selected');
        germanBtn.classList.add('correct');
        translationBtn.classList.add('correct');

        // Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø¯Ù‘Ù…: Ù†Ø³ØªØ®Ø¯Ù… globalIndex Ø§Ù„ÙƒØ§Ù…Ù„
        appData.sentencesProgress.completedItems.add(String(germanSentence.globalIndex));
        saveProgress();
        elements.correctSound.currentTime = 0;
        elements.correctSound.play();

        // Ø¥Ø¹Ø§Ø¯Ø© ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª Ø¨Ø¹Ø¯ Ù„Ø­Ø¸Ø© Ø¨Ø³ÙŠØ·Ø© ÙˆØ¥Ø¹Ø§Ø¯Ø© Ø±Ù†Ø¯Ø±/ØªÙ‚Ø¯Ù… Ø§Ù„ØµÙØ­Ø© Ø¥Ù† Ù„Ø²Ù…
        setTimeout(() => {
            clearSelectionTempSentences();
            // Ø¥Ù† ÙƒØ§Ù†Øª ÙƒÙ„ Ø¹Ù†Ø§ØµØ± Ø§Ù„ØµÙØ­Ø© ØµØ­ÙŠØ­Ø© -> Ù†Ù†ØªÙ‚Ù„ Ù„Ù„ØµÙØ­Ø© Ø§Ù„ØªØ§Ù„ÙŠØ© Ø£Ùˆ Ù†Ø¹Ø±Ø¶ Ø§ÙƒØªÙ…Ø§Ù„
            const allGermanBtns = document.querySelectorAll('.german-sentence');
            const allCorrect = Array.from(allGermanBtns).every(b => b.classList.contains('correct'));
            if (allCorrect) {
                // Ø²ÙŠØ§Ø¯Ø© ØµÙØ­Ø© Ø¥Ù† Ù„Ù… ØªÙƒÙ† Ø§Ù„Ø£Ø®ÙŠØ±Ø©
                const totalPages = Math.ceil(appData.sentences.length / appData.sentencesProgress.itemsPerPage);
                if (appData.sentencesProgress.currentPage < totalPages) {
                    appData.sentencesProgress.currentPage++;
                } else {
                    // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¬Ù…Ù„ Ù…ÙƒØªÙ…Ù„Ø© ÙÙŠ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ ÙƒÙƒÙ„
                    if (appData.sentencesProgress.completedItems.size >= appData.sentences.length) {
                        elements.sentencesChallenge.innerHTML = '';
                        elements.sentencesCompletionMessage.classList.remove('hidden');
                    }
                }
                saveProgress();
                renderSentencesChallenge();
            }
        }, 700);

    } else {
        // ØªÙ…ÙŠÙŠØ² Ø®Ø·Ø£
        germanBtn.classList.remove('selected');
        translationBtn.classList.remove('selected');
        germanBtn.classList.add('incorrect');
        translationBtn.classList.add('incorrect');
        elements.incorrectSound.currentTime = 0;
        elements.incorrectSound.play();

        setTimeout(() => {
            germanBtn.classList.remove('incorrect');
            translationBtn.classList.remove('incorrect');
            clearSelectionTempSentences();
        }, 800);
    }
}

/* -------------------------
   Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù…Ø³Ø­ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…Ø¤Ù‚ØªØ© - Ù‚Ø³Ù… Ø§Ù„ÙƒÙ„Ù…Ø§Øª
   ------------------------- */
function clearSelectionTemp() {
    appData.selectedGermanObj = null;
    appData.selectedTranslationText = null;
    document.querySelectorAll('.german-word').forEach(b => b.classList.remove('selected'));
    document.querySelectorAll('.translation-word').forEach(b => b.classList.remove('selected'));
}

/* -------------------------
   Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù…Ø³Ø­ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…Ø¤Ù‚ØªØ© - Ù‚Ø³Ù… Ø§Ù„Ø¬Ù…Ù„
   ------------------------- */
function clearSelectionTempSentences() {
    appData.selectedGermanSentence = null;
    appData.selectedTranslationSentence = null;
    document.querySelectorAll('.german-sentence').forEach(b => b.classList.remove('selected'));
    document.querySelectorAll('.translation-sentence').forEach(b => b.classList.remove('selected'));
}

/* -------------------------
   ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙˆØ´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… - Ù‚Ø³Ù… Ø§Ù„ÙƒÙ„Ù…Ø§Øª
   ------------------------- */
function updateWordsStats() {
    const total = appData.words.length;
    const completed = appData.wordsProgress.completedItems.size;
    const remaining = Math.max(0, total - completed);
    elements.wordsTotalCount.textContent = total;
    elements.wordsCompletedCount.textContent = completed;
    elements.wordsRemainingCount.textContent = remaining;
}

function updateWordsProgressBar() {
    const total = appData.words.length || 1;
    const completed = appData.wordsProgress.completedItems.size;
    const percent = Math.round((completed / total) * 100);
    elements.wordsProgressBar.style.width = percent + '%';
    elements.wordsProgressPercent.textContent = percent + '%';
}

/* -------------------------
   ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙˆØ´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… - Ù‚Ø³Ù… Ø§Ù„Ø¬Ù…Ù„
   ------------------------- */
function updateSentencesStats() {
    const total = appData.sentences.length;
    const completed = appData.sentencesProgress.completedItems.size;
    const remaining = Math.max(0, total - completed);
    elements.sentencesTotalCount.textContent = total;
    elements.sentencesCompletedCount.textContent = completed;
    elements.sentencesRemainingCount.textContent = remaining;
}

function updateSentencesProgressBar() {
    const total = appData.sentences.length || 1;
    const completed = appData.sentencesProgress.completedItems.size;
    const percent = Math.round((completed / total) * 100);
    elements.sentencesProgressBar.style.width = percent + '%';
    elements.sentencesProgressPercent.textContent = percent + '%';
}

/* -------------------------
   Ø§Ù„ØªÙ†Ù‚Ù‘Ù„ ÙˆØ£Ø²Ø±Ø§Ø± Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
   ------------------------- */
function updateWordsNavButtons() {
    const p = appData.wordsProgress;
    const totalPages = Math.max(1, Math.ceil(appData.words.length / p.itemsPerPage));
    document.getElementById('words-prev-btn').disabled = (p.currentPage <= 1);
    document.getElementById('words-next-btn').disabled = (p.currentPage >= totalPages);
}

function updateSentencesNavButtons() {
    const p = appData.sentencesProgress;
    const totalPages = Math.max(1, Math.ceil(appData.sentences.length / p.itemsPerPage));
    document.getElementById('sentences-prev-btn').disabled = (p.currentPage <= 1);
    document.getElementById('sentences-next-btn').disabled = (p.currentPage >= totalPages);
}

/* -------------------------
   Ù…Ø³Ø§Ø¹Ø¯Ø©: ØªØ£Ù…ÙŠÙ† Ù†Øµ HTML
   ------------------------- */
function escapeHtml(unsafe) {
    if (unsafe === null || unsafe === undefined) return '';
    return String(unsafe)
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;")
        .replace(/"/g, "&quot;")
        .replace(/'/g, "&#039;");
}

/* -------------------------
   Ø¥Ø¸Ù‡Ø§Ø± ÙˆØ¥Ø®ÙØ§Ø¡ Ø§Ù„ØµÙØ­Ø§Øª
   ------------------------- */
function showHomePage() {
    elements.homePage.classList.remove('hidden');
    elements.wordsContainer.classList.add('hidden');
    elements.sentencesContainer.classList.add('hidden');
}

function showWordsSection() {
    elements.homePage.classList.add('hidden');
    elements.wordsContainer.classList.remove('hidden');
    elements.sentencesContainer.classList.add('hidden');
    appData.currentSection = 'words';
    renderWordsChallenge();
    updateWordsNavButtons();
}

function showSentencesSection() {
    elements.homePage.classList.add('hidden');
    elements.wordsContainer.classList.add('hidden');
    elements.sentencesContainer.classList.remove('hidden');
    appData.currentSection = 'sentences';
    renderSentencesChallenge();
    updateSentencesNavButtons();
}

/* -------------------------
   ÙˆØ¸ÙŠÙØ© Ø²Ø± Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
   ------------------------- */
function goToHomePage() {
    window.location.href = 'index.html';
}

/* -------------------------
   Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø£Ø²Ø±Ø§Ø± ÙˆØªÙ‡ÙŠØ¦Ø© Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
   ------------------------- */
function setupEventListeners() {
    elements.wordsSectionCard.addEventListener('click', showWordsSection);
    elements.sentencesSectionCard.addEventListener('click', showSentencesSection);

    elements.wordsBackBtn.addEventListener('click', showHomePage);
    elements.sentencesBackBtn.addEventListener('click', showHomePage);

    elements.wordsPrevBtn.addEventListener('click', () => {
        if (appData.wordsProgress.currentPage > 1) {
            appData.wordsProgress.currentPage--;
            saveProgress();
            renderWordsChallenge();
            updateWordsNavButtons();
        }
    });

    elements.wordsNextBtn.addEventListener('click', () => {
        const totalPages = Math.max(1, Math.ceil(appData.words.length / appData.wordsProgress.itemsPerPage));
        if (appData.wordsProgress.currentPage < totalPages) {
            appData.wordsProgress.currentPage++;
            saveProgress();
            renderWordsChallenge();
            updateWordsNavButtons();
        }
    });

    elements.wordsResetBtn.addEventListener('click', () => {
        const ok = confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ­Ø¯Ù‘ÙŠ Ù„Ù…Ø³Ø­ Ø§Ù„ØªÙ‚Ø¯Ù‘Ù… ÙÙŠ Ù‚Ø³Ù… Ø§Ù„ÙƒÙ„Ù…Ø§ØªØŸ');
        if (ok) {
            appData.wordsProgress.currentPage = 1;
            appData.wordsProgress.completedItems.clear();
            saveProgress();
            renderWordsChallenge();
            updateWordsNavButtons();
        }
    });

    elements.sentencesPrevBtn.addEventListener('click', () => {
        if (appData.sentencesProgress.currentPage > 1) {
            appData.sentencesProgress.currentPage--;
            saveProgress();
            renderSentencesChallenge();
            updateSentencesNavButtons();
        }
    });

    elements.sentencesNextBtn.addEventListener('click', () => {
        const totalPages = Math.max(1, Math.ceil(appData.sentences.length / appData.sentencesProgress.itemsPerPage));
        if (appData.sentencesProgress.currentPage < totalPages) {
            appData.sentencesProgress.currentPage++;
            saveProgress();
            renderSentencesChallenge();
            updateSentencesNavButtons();
        }
    });

    elements.sentencesResetBtn.addEventListener('click', () => {
        const ok = confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ­Ø¯Ù‘ÙŠ Ù„Ù…Ø³Ø­ Ø§Ù„ØªÙ‚Ø¯Ù‘Ù… ÙÙŠ Ù‚Ø³Ù… Ø§Ù„Ø¬Ù…Ù„ØŸ');
        if (ok) {
            appData.sentencesProgress.currentPage = 1;
            appData.sentencesProgress.completedItems.clear();
            saveProgress();
            renderSentencesChallenge();
            updateSentencesNavButtons();
        }
    });

    // ØªÙØ¹ÙŠÙ„/ØªØ¹Ø·ÙŠÙ„ Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙ†Ù‚Ù„ Ø¹Ù†Ø¯ ØªØºÙŠØ± Ø§Ù„Ù…Ø­ØªÙˆÙ‰
    document.addEventListener('click', () => {
        updateWordsNavButtons();
        updateSentencesNavButtons();
    });
}

/* -------------------------
   ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙˆØªØ´ØºÙŠÙ„Ù‡
   ------------------------- */
async function initApp() {
    try {
        await loadData();
        loadProgress();
        setupEventListeners();

        // Ø¥Ø®ÙØ§Ø¡ Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
        if (elements.loadingMessage) elements.loadingMessage.classList.add('hidden');

        // Ø¹Ø±Ø¶ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ø§ÙØªØ±Ø§Ø¶ÙŠÙ‹Ø§
        showHomePage();

        // ØªÙ‡ÙŠØ¦Ø© Ø£ØµÙˆØ§Øª Ø§Ù„Ù†Ø·Ù‚
        if ('speechSynthesis' in window) {
            speechSynthesis.getVoices(); // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£ØµÙˆØ§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©
        }

        console.log('Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¬Ø§Ù‡Ø².');
    } catch (err) {
        console.error('Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªÙ‡ÙŠØ¦Ø©:', err);
    }
}

/* -------------------------
   Ø¨Ø¯Ø¡ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ DOM
   ------------------------- */
document.addEventListener('DOMContentLoaded', initApp);
</script>